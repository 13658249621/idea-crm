
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../../favicon.ico">
    <link type="text/css" href="bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link type="text/css" href="bootstrap/css/bootstrap-table.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="themes/gray/easyui.css">
    <link rel="stylesheet" type="text/css" href="themes/icon.css">
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="../../assets/css/ie10-viewport-bug-workaround.css" rel="stylesheet">
    <!-- Custom styles for this template -->
    <link href="offcanvas.css" rel="stylesheet">
    <title>管理报修信息</title>
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="js/easyui-lang-zh_CN.js"></script>
    <!-- 加载 Bootstrap 的所有 JavaScript 插件。你也可以根据需要只加载单个插件。 -->
    <script type="text/javascript" src="bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/bootstrap-table.js";></script>
    <script type="text/javascript" src="bootstrap/js/bootstrap-table-zh-CN.min.js"></script>
    <script type="text/javascript" src="js/Util.js"></script>
</head>

<body  style="background: url(https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1582826068275&di=ceda3df1e2da2b76833288340f0d9981&imgtype=0&src=http%3A%2F%2Fimg.1ppt.com%2Fuploads%2Fallimg%2F1511%2F1_151125155652_1.jpg) no-repeat center ; background-size: cover;">
<nav class="navbar navbar-fixed-top navbar-inverse">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar"
                    aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">物业管理系统</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li class="active"><a href="home.html">主页</a></li>
                <li><a href="#about">关于我们</a></li>
                <li><a href="#contact">联系我们</a></li>
                <li><a href="index.html">退出登录</a></li>
            </ul>
        </div><!-- /.nav-collapse -->
    </div><!-- /.container -->
</nav><!-- /.navbar -->
<div class="container">

    <div class="row row-offcanvas row-offcanvas-right">

        <div class="col-xs-12 col-sm-9" style="margin-top: 90px">
            <p class="pull-right visible-xs">
                <button type="button" class="btn btn-primary btn-xs" data-toggle="offcanvas"></button>
            </p>
            <!-- <div style="margin-top: 90px">
                 <input type="date" id="date"/>
                 <button id="getdate" onclick="getdate()"> 获取时间</button>
             </div>    日期选择器-->
            <div class="col-xs-12 col-sm-12" style="height: fit-content">

                <button class="btn btn-primary" onclick="initBootstrapTable()">查看所有报修信息</button>
                <button class="btn btn-primary" onclick="EditSelect()">编辑报修信息</button>
                <button type="button" class="btn btn-danger" onclick="deleteSelect()" >删除
                </button>
                <table id="parking-table" class="table table-bordered" data-toggle="table"  >
                </table>

                <button type="button" class="btn btn-success" onclick="post()">查看我的车位
                </button>
                <p></p>
                <div>如需购买车位服务，请与相关工作人员联系</div>
            </div>

        </div><!--/.col-xs-12.col-sm-9-->

        <div class="col-xs-6 col-sm-2 sidebar-offcanvas" id="sidebar">
            <div class="list-group" style="margin-top: 60px">
                <a href="#"  disabled="true" class="list-group-item active" style="background-color: #3c3c3c">快速导航</a>
                <a href="fix.html" class="list-group-item"><p>我要报修</p></a>
                <a href="parking.html" class="list-group-item"><p>查询车位</p></a>
                <a href="pay.html" class="list-group-item"><p>缴费信息</p></a>
                <a href="suggestion.html" class="list-group-item"><p>投诉和建议</p></a>
                <a href="notice.html" class="list-group-item"><p>查看社区公告</p></a>
                <select class="list-group-item" style="width: 100%;font-size: 14px;color: dimgray" name="here "
                        onchange="location.href=this.options[this.selectedIndex].value;">
                    <option disabled selected hidden>业主管理</option>
                    <option value="ManageProprietor.html">查询业主信息</option>
                    <option value="EditProprietor.html">管理业主信息</option>
                </select>
                <select class="list-group-item" style="width: 100%;font-size: 14px;color: dimgray" name="here "
                        onchange="location.href=this.options[this.selectedIndex].value;" id="ManageHouse">
                    <option disabled selected hidden>楼栋管理</option>
                    <option value="ManageHouse.html">查询楼栋房屋信息</option>
                    <option value="EditHouse.html">管理楼栋房屋信息</option>
                </select>
                <select class="list-group-item" style="width: 100%;font-size: 14px;color: dimgray" name="here "
                        onchange="location.href=this.options[this.selectedIndex].value;" id="ManageFix">
                    <option disabled selected hidden>报修管理</option>
                    <option value="ManageFix.html">查询报修</option>
                    <option value="EditFix.html">管理报修(删除，编辑)</option>
                </select>
                <select class="list-group-item" style="width: 100%;font-size: 14px;color: dimgray" name="here "
                        onchange="location.href=this.options[this.selectedIndex].value;" id="ManageParking">
                    <option disabled selected hidden>车位管理</option>
                    <option value="ManageParking.html">查询车位</option>
                     <option value="AddParking.html">添加车位</option>
                </select>
                <select class="list-group-item" style="width: 100%;font-size: 14px;color: dimgray" name="here "
                        onchange="location.href=this.options[this.selectedIndex].value;" id="ManagePay">
                    <option disabled selected hidden>缴费管理</option>
                    <option value="ManagePay.html">查询缴费</option>
                    <option value="AddPay.html">发布缴费项目</option>
                </select>
                <select class="list-group-item" style="width: 100%;font-size: 14px;color: dimgray" name="here "
                        onchange="location.href=this.options[this.selectedIndex].value;" id="ManageSugg">
                    <option disabled selected hidden>投诉和建议管理</option>
                    <option value="ManageSugg.html">查询投诉和建议</option>
                    <option value="EditSugg.html">删除投诉和建议</option>
                </select>
                <select class="list-group-item" style="width: 100%;font-size: 14px;color: dimgray" name="here "
                        onchange="location.href=this.options[this.selectedIndex].value;" id="ManageNotice">
                    <option disabled selected hidden>社区公告管理</option>
                    <option value="ManageNotice.html">查询社区公告</option>
                    <option value="EditNotice.html">发布社区公告</option>
                </select>
                <select class="list-group-item" style="width: 100%;font-size: 14px;color: dimgray" name="here "
                        onchange="location.href=this.options[this.selectedIndex].value;" id="ManageUser">
                    <option disabled selected hidden>用户管理</option>
                    <option value="ManageUser.html">查询用户</option>
                    <option value="EditUser.html">添加用户</option>
                </select>
            </div>
        </div><!--/.sidebar-offcanvas-->
    </div><!--/row-->

    <hr>

    <footer>
        <p>&copy;权限归属 物业管理公司</p>
    </footer>

    </div><!--/.container-->
</div>
</body>
<script type="text/javascript">
    $.extend($.fn.bootstrapTable.defaults, $.fn.bootstrapTable.locales['zh-CN']);
    function initBootstrapTable() {
        $("#parking-table").bootstrapTable('destroy');
        $('#parking-table').bootstrapTable({
            url: 'AllFix',             //请求后台的URL（*）
            method: 'post',                      //请求方式（*）
            toolbar: '#toolbar',                //工具按钮用哪个容器
            striped: true,                      //是否显示行间隔色
            cache: false,
            selectItemName: "PLis",              //radio 或者 checkbox 的字段 name 名。
            idField: "parkingplace",
            pagination: true,                   //是否显示分页（*）
            queryParams: 'queryParams',         //传递参数（*）
            sidePagination: "client",           //分页方式：client客户端分页，server服务端分页（*）
            pageNumber: 1,                       //初始化加载第一页，默认第一页
            pageSize: 10,                       //每页的记录行数（*）
            pageList: [5, 10, 15, 20],        //可供选择的每页的行数（*）
            smartDisplay: false,
            singleSelect: true,
            checkboxHeader: true,
            search: true,                      //是否显示表格搜索，此搜索是客户端搜索，不会进服务端，所以，个人感觉意义不大
            strictSearch: false,
            showColumns: false,                 //是否显示所有的列
            showRefresh: true,                  //是否显示刷新按钮
            searchAlign: "left",
            toolbarAlign: "left",
            minimumCountColumns: 2,             //最少允许的列数
            clickToSelect: true,                //是否启用点击选中行
            //每一行的唯一标识，一般为主键列
            showToggle: false,                   //是否显示详细视图和列表视图的切换按钮
            cardView: false,                    //是否显示详细视图
            detailView: false,//是否显示父子表
            columns: [
                {
                    checkbox: true,
                },
                {
                    field: 'fixid',
                    title: '报修编号',
                    uniqueId: "selected"
                }, {
                    field: 'danyuan',
                    title: '单元',
                }, {
                    field: 'louceng',
                    title: '楼层',
                }, {
                    field: 'fangjian',
                    title: '房间',
                }, {
                    field: 'phone',
                    title: '电话',
                }, {
                    field: 'info',
                    title: '备注',
                }
                , {
                    field: 'date',
                    title: '日期',
                }, {
                    field: 'state',
                    title: '状态',
                }, {
                    field: 'uname',
                    title: '报修用户',
                }
            ],
        });
    }//初始化boot strap table
    function post(){
        $("#parking-table").bootstrapTable('destroy');
        $('#parking-table').bootstrapTable({
            url:'AllFix',             //请求后台的URL（*）
            method: 'post',                      //请求方式（*）
            toolbar: '#toolbar',                //工具按钮用哪个容器
            striped: true,                      //是否显示行间隔色
            cache: false,
            selectItemName:"PLis",              //radio 或者 checkbox 的字段 name 名。
            idField:"parkingplace",
            pagination: true,                   //是否显示分页（*）
            queryParams:"testuname",         //传递参数（*）
            sidePagination: "client",           //分页方式：client客户端分页，server服务端分页（*）
            pageNumber:1,                       //初始化加载第一页，默认第一页
            pageSize: 10,                       //每页的记录行数（*）
            pageList: [5, 10, 15, 20],        //可供选择的每页的行数（*）
            smartDisplay:false,
            singleSelect:true,
            checkboxHeader:true,
            search: true,                      //是否显示表格搜索，此搜索是客户端搜索，不会进服务端，所以，个人感觉意义不大
            strictSearch: false,
            showColumns: false,                 //是否显示所有的列
            showRefresh: true,                  //是否显示刷新按钮
            searchAlign:"left",
            toolbarAlign:"left",
            minimumCountColumns: 2,             //最少允许的列数
            clickToSelect: true,                //是否启用点击选中行
            //每一行的唯一标识，一般为主键列
            showToggle:false,                   //是否显示详细视图和列表视图的切换按钮
            cardView: false,                    //是否显示详细视图
            detailView: false,//是否显示父子表
            columns: [
                {
                    checkbox: true,
                },
                {
                    field: 'fixid',
                    title: '报修编号',
                    uniqueId: "selected"
                }, {
                    field: 'danyuan',
                    title: '单元',
                }, {
                    field: 'louceng',
                    title: '楼层',
                }, {
                    field: 'fangjian',
                    title: '房间',
                }, {
                    field: 'phone',
                    title: '电话',
                }, {
                    field: 'info',
                    title: '备注',
                }
                , {
                    field: 'date',
                    title: '日期',
                }, {
                    field: 'state',
                    title: '状态',
                }, {
                    field: 'uname',
                    title: '报修用户',
                }
            ],
        });
    }//查看我的车位
    function deleteSelect(){
        var FixItem = $('#parking-table').bootstrapTable('getSelections');
        if (FixItem.length <= 0){
            alert("请选择您要删除的一项");
        }else{
            var fixid=GetValue(FixItem,"fixid");
            console.log("fixid是:"+fixid);
            $.ajax({
                type : "POST", //传数据的方式
                url : "AllPay", //servlet地址
                data : {
                    "fixid": fixid
                }, //传的数据  form表单 里面的数据
                success : function(result) { //传数据成功之后的操作   result是servlet传过来的数据  这个函数对result进行处理，让它显示在 输入框中
                    initBootstrapTable();
                }
            });
        }
    };//删除报修信息请求

    function EditSelect(){
        var FixItem = $('#parking-table').bootstrapTable('getSelections');
        console.log("FixItem是:"+FixItem);
        if (FixItem.length <= 0){
            alert("请选择您要删除的一项");
        }else{
            var fixid=GetValue(FixItem,"fixid");
            var state=GetValue(FixItem,"state");
            var danyuan=GetValue(FixItem,"danyuan");
            var louceng=GetValue(FixItem,"louceng");
            var fangjian=GetValue(FixItem,"fangjian");
            var phone=GetValue(FixItem,"phone");
            var date=GetValue(FixItem,"date");
            var uname=GetValue(FixItem,"uname");
            console.log("fixid是:"+fixid);
            sessionStorage.setItem("FixIdPlaceStash",fixid);
            sessionStorage.setItem("FixStateStash",state);
            sessionStorage.setItem("FixDanyuanStash",danyuan);
            sessionStorage.setItem("FixLoucengStash",louceng);
            sessionStorage.setItem("FixFangjianStash",fangjian);
            sessionStorage.setItem("FixPhoneStash",phone);
            sessionStorage.setItem("FixDateStash",date);
            sessionStorage.setItem("FixUnameStash",uname);
            window.location.href="EditFix.html";
        }
    };//编辑车位信息，保存parkingpalce到sessionstorage，跳转到添加车位页面
    window.onload=checksessoin();
    window.onload=CheckPower;
    window.onload=initBootstrapTable();//初始化bootstrap-table，查询所有车位信息
</script>
</html>
